/*!art-template - Template Engine | http://aui.github.com/artTemplate/*/

!function(e,t){"use strict";"function"==typeof define&&define.amd?define("util/fetch",[],t):"object"==typeof exports?module.exports=t():t().polyfill()}(this,function(){"use strict";function e(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function t(e){return"string"!=typeof e&&(e=e.toString()),e}function n(e){this.map={};var t=this;e instanceof n?e.forEach(function(e,n){n.forEach(function(n){t.append(e,n)})}):e&&Object.getOwnPropertyNames(e).forEach(function(n){t.append(n,e[n])})}function r(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function o(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function i(e){var t=new FileReader;return t.readAsArrayBuffer(e),o(t)}function a(e){var t=new FileReader;return t.readAsText(e),o(t)}function s(){return this.bodyUsed=!1,m.blob?(this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):(this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},this.text=function(){var e=r(this);return e?e:Promise.resolve(this._bodyText)}),m.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(e){var t=e.toUpperCase();return y.indexOf(t)>-1?t:e}function c(e,t){if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new n(t.headers),this.method=u(t.method||"GET"),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function l(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function f(e){var t=new n,r=e.getAllResponseHeaders().trim().split("\n");return r.forEach(function(e){var n=e.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();t.append(r,o)}),t}function p(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers,this.url=t.url||""}function d(e,t){return new c(e,t).fetch()}function h(){var e="undefined"!=typeof global?global:self;e.fetch||(e.Headers=n,e.Request=c,e.Response=p,e.fetch=d)}n.prototype.append=function(n,r){n=e(n),r=t(r);var o=this.map[n];o||(o=[],this.map[n]=o),o.push(r)},n.prototype.delete=function(t){delete this.map[e(t)]},n.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},n.prototype.getAll=function(t){return this.map[e(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(n,r){this.map[e(n)]=[t(r)]},n.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach(function(n){e(n,t.map[n])})};var m={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self},y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];return c.prototype.fetch=function(){var e=this;return new Promise(function(t,n){function r(){return"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0}var o=new XMLHttpRequest;"cors"===e.credentials&&(o.withCredentials=!0),o.onload=function(){var e=1223===o.status?204:o.status;if(e<100||e>599)return void n(new TypeError("Network request failed"));var i={status:e,statusText:o.statusText,headers:f(o),url:r()},a="response"in o?o.response:o.responseText;t(new p(a,i))},o.onerror=function(){n(new TypeError("Network request failed"))},o.open(e.method,e.url,!0),"responseType"in o&&m.blob&&(o.responseType="blob"),e.headers.forEach(function(e,t){t.forEach(function(t){o.setRequestHeader(e,t)})}),o.send("undefined"==typeof e._bodyInit?null:e._bodyInit)})},s.call(c.prototype),d.polyfill=!0,s.call(p.prototype),{Headers:n,Request:c,Response:p,fetch:d,polyfill:h}}),define("services/service",["../util/fetch"],function(e){function t(e,t){var n="json";switch(t){case"html":n="text";break;case"json":n="json";break;default:n="json"}return new Promise(function(t,r){return e.then(function(e){return e[n]().then(function(e){t(e)},function(e){r(e)})})})}return{getName:function(n){return t(e.fetch("http://www.mayfou.com/index.php?g=interface&m=meifou&a=getUser&appver=40100&client=html5&pk=99D6B47A6034543318A73BD4ED0A017F&timestamp=1479461606&userid=1710718",{method:"GET"}))},getHtml:function(){return t(e.fetch("./modal.html"),"html")}}}),define("util/util",[],function(){return{userSex:"man"}}),!function(){function e(e){return e.replace(v,"").replace($,",").replace(w,"").replace(T,"").replace(E,"").split(/^$|,+/)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function n(n,r){function o(e){return p+=e.split(/\n/).length-1,l&&(e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"")),e&&(e=g[1]+t(e)+g[2]+"\n"),e}function i(t){var n=p;if(c?t=c(t,r):a&&(t=t.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===t.indexOf("=")){var o=f&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),o){var i=t.replace(/\s*\([^\)]+\)/,"");d[i]||/^(include|print)$/.test(i)||(t="$escape("+t+")")}else t="$string("+t+")";t=g[1]+t+g[2]}return a&&(t="$line="+n+";"+t),b(e(t),function(e){if(e&&!m[e]){var t;t="print"===e?$:"include"===e?w:d[e]?"$utils."+e:h[e]?"$helpers."+e:"$data."+e,T+=e+"="+t+",",m[e]=!0}}),t+"\n"}var a=r.debug,s=r.openTag,u=r.closeTag,c=r.parser,l=r.compress,f=r.escape,p=1,m={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},y="".trim,g=y?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],v=y?"$out+=text;return $out;":"$out.push(text);",$="function(){var text=''.concat.apply('',arguments);"+v+"}",w="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+v+"}",T="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(a?"$line=0,":""),E=g[0],x="return new String("+g[3]+");";b(n.split(s),function(e){e=e.split(u);var t=e[0],n=e[1];1===e.length?E+=o(t):(E+=i(t),n&&(E+=o(n)))});var _=T+E+x;a&&(_="try{"+_+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(n)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')};}");try{var B=new Function("$data","$filename",_);return B.prototype=d,B}catch(e){throw e.temp="function anonymous($data,$filename) {"+_+"}",e}}var r=function(e,t){return"string"==typeof t?y(t,{filename:e}):a(e,t)};r.version="3.0.0",r.config=function(e,t){o[e]=t};var o=r.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},i=r.cache={};r.render=function(e,t){return y(e,t)};var a=r.renderFile=function(e,t){var n=r.get(e)||m({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n};r.get=function(e){var t;if(i[e])t=i[e];else if("object"==typeof document){var n=document.getElementById(e);if(n){var r=(n.value||n.innerHTML).replace(/^\s*|\s*$/g,"");t=y(r,{filename:e})}}return t};var s=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?s(e.call(e)):""),e},u={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},c=function(e){return u[e]},l=function(e){return s(e).replace(/&(?![\w#]+;)|[<>"']/g,c)},f=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,t){var n,r;if(f(e))for(n=0,r=e.length;r>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)},d=r.utils={$helpers:{},$include:a,$string:s,$escape:l,$each:p};r.helper=function(e,t){h[e]=t};var h=r.helpers=d.$helpers;r.onerror=function(e){var t="Template Error\n\n";for(var n in e)t+="<"+n+">\n"+e[n]+"\n\n";"object"==typeof console&&console.error(t)};var m=function(e){return r.onerror(e),function(){return"{Template Error}"}},y=r.compile=function(e,t){function r(n){try{return new u(n,s)+""}catch(r){return t.debug?m(r)():(t.debug=!0,y(e,t)(n))}}t=t||{};for(var a in o)void 0===t[a]&&(t[a]=o[a]);var s=t.filename;try{var u=n(e,t)}catch(e){return e.filename=s||"anonymous",e.name="Syntax Error",m(e)}return r.prototype=u.prototype,r.toString=function(){return u.toString()},s&&t.cache&&(i[s]=r),r},b=d.$each,g="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",v=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,$=/[^\w$]+/g,w=new RegExp(["\\b"+g.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),T=/^\d[^,]*|,\d[^,]*/g,E=/^,+|,+$/g;o.openTag="{{",o.closeTag="}}";var x=function(e,t){var n=t.split(":"),r=n.shift(),o=n.join(":")||"";return o&&(o=", "+o),"$helpers."+r+"("+e+o+")"};o.parser=function(e,t){e=e.replace(/^\s/,"");var n=e.split(" "),o=n.shift(),i=n.join(" ");switch(o){case"if":e="if("+i+"){";break;case"else":n="if"===n.shift()?" if("+n.join(" ")+")":"",e="}else"+n+"{";break;case"/if":e="}";break;case"each":var a=n[0]||"$data",s=n[1]||"as",u=n[2]||"$value",c=n[3]||"$index",l=u+","+c;"as"!==s&&(a="[]"),e="$each("+a+",function("+l+"){";break;case"/each":e="});";break;case"echo":e="print("+i+");";break;case"print":case"include":e=o+"("+n.join(",")+");";break;default:if(-1!==i.indexOf("|")){var f=t.escape;0===e.indexOf("#")&&(e=e.substr(1),f=!1);for(var p=0,d=e.split("|"),h=d.length,m=f?"$escape":"$string",y=m+"("+d[p++]+")";h>p;p++)y=x(y,d[p]);e="=#"+y}else e=r.helpers[o]?"=#"+o+"("+n.join(",")+");":"="+e}return e},"function"==typeof define?define("util/template",[],function(){return r}):"undefined"!=typeof exports?module.exports=r:this.template=r}(),require(["services/service","util/util","util/template"],function(e,t,n){function r(){o.list=o.list.concat(["文艺","博客","摄影","电影","民谣","旅行","吉他","哈哈"]);var e=n("test",o);document.getElementById("app").innerHTML=e}var o={title:"标签",list:["文艺","博客","摄影","电影","民谣","旅行","吉他"]};e.getHtml().then(function(t){document.querySelector(".template").innerHTML=t,e.getName("xudao").then(function(e){console.log(e);var t=n("test",o);document.getElementById("app").innerHTML=t})},function(e){console.log(e)}),document.getElementById("button").addEventListener("click",function(){r()})}),define("controllers/main",function(){});